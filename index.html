<!DOCTYPE html>

<html lang="en">

<head>
    <title>My awesome blog</title>
</head>

<body>
    <h1>My awesome blog</h1>

    <section>
        <h2>News form</h2>

        <form>
            <div>
                <label>Title</label><br/>
                <input type="text" name="titleToAdd" />
            </div>

            <div>
                <label>Description</label><br/>
                <textarea name="descriptionToAdd"></textarea>
            </div>

            <input type="submit" value="Submit" />
        </form>
    </section>

    <section>
        <h2>My news</h2>
        <h3></h3>

        <div id="newsList">
        </div>
    </section>

    <script>
        /*1 fonction qui récupère le nombre d'article (les articles sont identifiés par la classe article et présents
         *dans la div ayant l'id newsList) sur la page et l'affiche dans la balise h3
         */
        function displayArticleCount() { //pour déclarer une fonction on utilise le mot clé function, suivi du nom puis des paramètres entre parenthèses
            const newsList = document.querySelector('#newsList');
            const articles = newsList.querySelectorAll('#newsList .article'); //retourne une liste d'élément HTML
            const h3 = document.querySelector('h3');

            if (articles.length > 1)
                h3.innerText = `There are ${articles.length} articles`;
            else
                h3.innerText = `There is ${articles.length} article`;
        }
        displayArticleCount();

        /*A la validation du formulaire, on récupère la valeur des 2 champs 
         *et on va créer un article 
         *(<article class="article"><span>$TITLE</span><p>$DESCRIPTION</p></article>)
         *et on l'insert dans la div ayant l'id newsList
         *Pour sélectionner un input on peut faire 'input[name=titleToAdd]'
         */
        const form = document.querySelector('form');
        form.addEventListener('submit', event => { //
            event.preventDefault(); //permet de bloquer le rechargement de la page à la validation du formulaire
            if (!checkForm()) {
                return false;
            }

            const titleToAdd = form.querySelector('input[name=titleToAdd]');
            const descriptionToAdd = form.querySelector('textarea[name=descriptionToAdd]');

            const title = titleToAdd.value;
            const description = descriptionToAdd.value;

            const article = document.createElement('article');
            const span = document.createElement('span');
            const p = document.createElement('p');

            span.innerText = title;
            p.innerText = description;
            article.appendChild(span);
            article.appendChild(p);
            article.classList.add('article'); //article.setAttribute('class', 'article');
            document.querySelector('#newsList').appendChild(article);

            displayArticleCount();

            titleToAdd.value = '';
            descriptionToAdd.value = '';

            return false; //permet de bloquer le rechargement de la page à la validation du formulaire
        });

        /*Créer une fonction qui vérifie que les donnéees du formulaire sont bien renseignés
         *De plus, si un champ est vide alors il devra être encadré en rouge
         */
        function checkForm() {
            const titleToAdd = form.querySelector('input[name=titleToAdd]'); //ici on récupère 1 seul élément ayant le tag input et l'attribut name avec la valeur titleToAdd
            const descriptionToAdd = form.querySelector('textarea[name=descriptionToAdd]'); //ici on récupère 1 seul élément ayant le tag textarea et l'attribut name avec la valeur descriptionToAdd
            let isValid = true;

            titleToAdd.setAttribute('style', 'border-color: inherit');
            descriptionToAdd.setAttribute('style', 'border-color: inherit');

            if (titleToAdd.value === '') {
                consol.error('Le champ titleToAdd n\'a pas été renseigné'); //console.error permet de mettre en avant (en rouge) un message dans la console
                titleToAdd.setAttribute('style', 'border-color: red'); //la méthode setAttribute permet de définir la valeur d'un attribut HTML de l'élément
                isValid = false;
            }

            if (descriptionToAdd.value === '') {
                consol.error('Le champ descriptionToAdd n\'a pas été renseigné'); //console.error permet de mettre en avant (en rouge) un message dans la console
                descriptionToAdd.setAttribute('style', 'border-color: red'); //la méthode setAttribute permet de définir la valeur d'un attribut HTML de l'élément
                isValid = false;
            }

            return isValid;
        }
    </script>
</body>

</html>